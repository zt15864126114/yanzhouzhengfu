import{d as me,a as M,r as p,v as ce,D as ve,c as _e,e,w as l,f as r,b as a,t as f,j as d,g as D,P as fe,m as x,J as U,i as ge,K as ye,x as be,N as he,Q as we,E as z,M as ke,o as w}from"./index-Dpg9Li3K.js";import{i as G}from"./index-u3wYLQ4o.js";import{_ as xe}from"./_plugin-vue_export-helper-DlAUqK2U.js";const Ce={class:"monitor-container"},Ve={class:"card-header"},Ue={class:"monitor-item"},ze={class:"item-value"},Ae={class:"item-progress"},Pe={class:"monitor-item"},Se={class:"item-value"},Be={class:"item-progress"},Re={class:"monitor-item"},Ee={class:"item-value"},Le={class:"item-progress"},Me={class:"monitor-item"},De={class:"item-value"},Fe={class:"item-progress"},Ne={class:"monitor-charts"},Te={class:"card-header"},$e={class:"header-right"},qe={class:"operation-bar"},Ke={class:"table-actions"},je={class:"pagination"},Oe={class:"card-header"},Ie={class:"header-right"},Je={class:"dialog-footer"},Qe=me({__name:"index",setup(Ge){const u=M({cpu:45,memory:60,storage:35,network:50}),A=p(!1),F=p([{id:1,time:"2024-03-20 10:30:00",level:"critical",content:"服务器CPU使用率超过90%",source:"服务器A"},{id:2,time:"2024-03-20 09:15:00",level:"warning",content:"存储空间使用率超过80%",source:"存储阵列B"},{id:3,time:"2024-03-19 16:45:00",level:"info",content:"系统更新可用",source:"系统"}]),N=p([...F.value]),H=p([{id:1,time:"2024-03-15 14:30:00",level:"info",module:"系统",content:"系统启动成功"},{id:2,time:"2024-03-15 14:29:00",level:"warning",module:"CPU",content:"CPU使用率超过80%"},{id:3,time:"2024-03-15 14:28:00",level:"error",module:"数据库",content:"数据库连接超时"},{id:4,time:"2024-03-15 14:27:00",level:"info",module:"网络",content:"网络设备状态检查完成"},{id:5,time:"2024-03-15 14:26:00",level:"warning",module:"存储",content:"存储空间使用率超过70%"},{id:6,time:"2024-03-15 14:25:00",level:"info",module:"安全",content:"安全扫描完成"},{id:7,time:"2024-03-15 14:24:00",level:"error",module:"应用",content:"应用服务响应超时"},{id:8,time:"2024-03-15 14:23:00",level:"info",module:"备份",content:"数据备份任务完成"}]),h=p(!1),P=p(),s=M({name:"",type:"",level:"",threshold:80,description:""}),W={name:[{required:!0,message:"请输入告警名称",trigger:"blur"},{min:3,max:20,message:"长度在 3 到 20 个字符",trigger:"blur"}],type:[{required:!0,message:"请选择告警类型",trigger:"change"}],level:[{required:!0,message:"请选择告警级别",trigger:"change"}]},T=p(),$=p(),i=M({keyword:"",level:""}),g=p(1),k=p(10),q=p(0),K=ce(()=>!!i.level||!!i.keyword),X=o=>({info:"info",warning:"warning",error:"danger"})[o]||"info",j=o=>o==="critical"?"严重":o==="warning"?"警告":o==="info"?"提示":o,Y=()=>{A.value=!0,setTimeout(()=>{A.value=!1,z.success("数据已刷新")},1e3)},Z=()=>{h.value=!0,s.name="",s.type="",s.level="",s.threshold=80,s.description=""},ee=o=>{ke.confirm(`确认删除告警"${o.name}"吗？`,"警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{z.success(`告警"${o.name}"已删除`)})},te=()=>{z.success("日志导出中")},le=async()=>{P.value&&await P.value.validate(o=>{o&&(h.value=!1,z.success("添加成功"))})},oe=()=>{const o=G(T.value);o.setOption({title:{text:"CPU使用率趋势"},tooltip:{trigger:"axis"},xAxis:{type:"category",data:["00:00","03:00","06:00","09:00","12:00","15:00","18:00","21:00"]},yAxis:{type:"value",max:100},series:[{data:[30,40,35,50,45,60,55,45],type:"line",smooth:!0}]});const t=G($.value);t.setOption({title:{text:"内存使用率趋势"},tooltip:{trigger:"axis"},xAxis:{type:"category",data:["00:00","03:00","06:00","09:00","12:00","15:00","18:00","21:00"]},yAxis:{type:"value",max:100},series:[{data:[50,55,60,65,70,65,60,55],type:"line",smooth:!0}]}),window.addEventListener("resize",()=>{o.resize(),t.resize()})},y=()=>{let o=[...F.value];i.keyword&&(o=o.filter(t=>t.content.includes(i.keyword)||t.source.includes(i.keyword))),i.level&&(o=o.filter(t=>t.level===i.level)),q.value=o.length,N.value=o.slice((g.value-1)*k.value,g.value*k.value)},O=()=>{i.keyword="",i.level="",g.value=1,y()},I=o=>{i[o]="",g.value=1,y()},ae=o=>{h.value=!0,s.name=o.name,s.type=o.type,s.level=o.level,s.threshold=o.threshold,s.description=o.description},ne=o=>{k.value=o,y()},se=o=>{g.value=o,y()};return ve(()=>{oe(),y()}),(o,t)=>{const S=r("el-icon"),m=r("el-button"),C=r("el-progress"),b=r("el-col"),B=r("el-row"),R=r("el-card"),E=r("el-input"),_=r("el-form-item"),c=r("el-option"),L=r("el-select"),J=r("el-form"),V=r("el-tag"),v=r("el-table-column"),Q=r("el-table"),ie=r("el-pagination"),re=r("el-input-number"),de=r("el-dialog"),ue=he("loading");return w(),_e("div",Ce,[e(B,{gutter:20},{default:l(()=>[e(b,{span:24},{default:l(()=>[e(R,{class:"monitor-card"},{header:l(()=>[a("div",Ve,[t[14]||(t[14]=a("span",null,"系统监控",-1)),e(m,{type:"primary",onClick:Y},{default:l(()=>[e(S,null,{default:l(()=>[e(D(fe))]),_:1}),t[13]||(t[13]=d("刷新 "))]),_:1,__:[13]})])]),default:l(()=>[e(B,{gutter:20},{default:l(()=>[e(b,{span:6},{default:l(()=>[a("div",Ue,[t[15]||(t[15]=a("div",{class:"item-title"},"CPU使用率",-1)),a("div",ze,f(u.cpu)+"%",1),a("div",Ae,[e(C,{percentage:u.cpu,status:u.cpu>80?"exception":""},null,8,["percentage","status"])])])]),_:1}),e(b,{span:6},{default:l(()=>[a("div",Pe,[t[16]||(t[16]=a("div",{class:"item-title"},"内存使用率",-1)),a("div",Se,f(u.memory)+"%",1),a("div",Be,[e(C,{percentage:u.memory,status:u.memory>80?"exception":""},null,8,["percentage","status"])])])]),_:1}),e(b,{span:6},{default:l(()=>[a("div",Re,[t[17]||(t[17]=a("div",{class:"item-title"},"存储使用率",-1)),a("div",Ee,f(u.storage)+"%",1),a("div",Le,[e(C,{percentage:u.storage,status:u.storage>80?"exception":""},null,8,["percentage","status"])])])]),_:1}),e(b,{span:6},{default:l(()=>[a("div",Me,[t[18]||(t[18]=a("div",{class:"item-title"},"网络带宽",-1)),a("div",De,f(u.network)+"Mbps",1),a("div",Fe,[e(C,{percentage:u.network,status:u.network>80?"exception":""},null,8,["percentage","status"])])])]),_:1})]),_:1}),a("div",Ne,[a("div",{ref_key:"cpuChartRef",ref:T,class:"chart"},null,512),a("div",{ref_key:"memoryChartRef",ref:$,class:"chart"},null,512)])]),_:1})]),_:1}),e(b,{span:24,class:"mt-20"},{default:l(()=>[e(R,null,{header:l(()=>[a("div",Te,[t[20]||(t[20]=a("span",null,"告警管理",-1)),a("div",$e,[e(m,{type:"primary",onClick:Z},{default:l(()=>[e(S,null,{default:l(()=>[e(D(ye))]),_:1}),t[19]||(t[19]=d("添加告警规则 "))]),_:1,__:[19]})])])]),default:l(()=>[a("div",qe,[e(J,{inline:!0,model:i,class:"search-form"},{default:l(()=>[e(_,null,{default:l(()=>[e(E,{modelValue:i.keyword,"onUpdate:modelValue":t[0]||(t[0]=n=>i.keyword=n),placeholder:"告警内容/来源",clearable:"",onKeyup:ge(y,["enter"])},null,8,["modelValue"])]),_:1}),e(_,null,{default:l(()=>[e(L,{modelValue:i.level,"onUpdate:modelValue":t[1]||(t[1]=n=>i.level=n),placeholder:"级别",clearable:"",style:{width:"120px"}},{default:l(()=>[e(c,{label:"严重",value:"critical"}),e(c,{label:"警告",value:"warning"}),e(c,{label:"提示",value:"info"})]),_:1},8,["modelValue"])]),_:1}),e(_,null,{default:l(()=>[e(m,{type:"primary",onClick:y},{default:l(()=>t[21]||(t[21]=[d("搜索")])),_:1,__:[21]}),e(m,{onClick:O},{default:l(()=>t[22]||(t[22]=[d("重置")])),_:1,__:[22]})]),_:1})]),_:1},8,["model"])]),K.value?(w(),x(B,{key:0,class:"filter-tags",style:{"margin-bottom":"10px"}},{default:l(()=>[i.level?(w(),x(V,{key:0,type:"info",closable:"",onClose:t[2]||(t[2]=()=>I("level"))},{default:l(()=>[d(" 级别："+f(j(i.level)),1)]),_:1})):U("",!0),i.keyword?(w(),x(V,{key:1,type:"info",closable:"",onClose:t[3]||(t[3]=()=>I("keyword"))},{default:l(()=>[d(" 关键词："+f(i.keyword),1)]),_:1})):U("",!0),K.value?(w(),x(m,{key:2,size:"small",type:"text",onClick:O},{default:l(()=>t[23]||(t[23]=[d("清除全部")])),_:1,__:[23]})):U("",!0)]),_:1})):U("",!0),e(Q,{data:N.value,border:"",style:{width:"100%"}},{default:l(()=>[e(v,{prop:"time",label:"时间","min-width":"160"}),e(v,{prop:"level",label:"级别","min-width":"80"},{default:l(({row:n})=>[e(V,{type:n.level==="critical"?"danger":n.level==="warning"?"warning":"info"},{default:l(()=>[d(f(j(n.level)),1)]),_:2},1032,["type"])]),_:1}),e(v,{prop:"content",label:"内容","min-width":"200"}),e(v,{prop:"source",label:"来源","min-width":"120"}),e(v,{label:"操作",width:"220"},{default:l(({row:n})=>[a("div",Ke,[e(m,{type:"primary",link:"",onClick:pe=>ae(n)},{default:l(()=>t[24]||(t[24]=[d("编辑")])),_:2,__:[24]},1032,["onClick"]),e(m,{type:"danger",link:"",onClick:pe=>ee(n)},{default:l(()=>t[25]||(t[25]=[d("删除")])),_:2,__:[25]},1032,["onClick"])])]),_:1})]),_:1},8,["data"]),a("div",je,[e(ie,{"current-page":g.value,"onUpdate:currentPage":t[4]||(t[4]=n=>g.value=n),"page-size":k.value,"onUpdate:pageSize":t[5]||(t[5]=n=>k.value=n),"page-sizes":[10,20,50,100],total:q.value,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:ne,onCurrentChange:se},null,8,["current-page","page-size","total"])])]),_:1})]),_:1}),e(b,{span:24,class:"mt-20"},{default:l(()=>[e(R,null,{header:l(()=>[a("div",Oe,[t[27]||(t[27]=a("span",null,"系统日志",-1)),a("div",Ie,[e(m,{type:"primary",onClick:te},{default:l(()=>[e(S,null,{default:l(()=>[e(D(we))]),_:1}),t[26]||(t[26]=d("导出日志 "))]),_:1,__:[26]})])])]),default:l(()=>[be((w(),x(Q,{data:H.value,style:{width:"100%"}},{default:l(()=>[e(v,{prop:"time",label:"时间",width:"180"}),e(v,{prop:"level",label:"级别"},{default:l(({row:n})=>[e(V,{type:X(n.level)},{default:l(()=>[d(f(n.level),1)]),_:2},1032,["type"])]),_:1}),e(v,{prop:"module",label:"模块"}),e(v,{prop:"content",label:"内容","show-overflow-tooltip":""})]),_:1},8,["data"])),[[ue,A.value]])]),_:1})]),_:1})]),_:1}),e(de,{modelValue:h.value,"onUpdate:modelValue":t[12]||(t[12]=n=>h.value=n),title:"添加告警规则",width:"600px"},{footer:l(()=>[a("span",Je,[e(m,{onClick:t[11]||(t[11]=n=>h.value=!1)},{default:l(()=>t[28]||(t[28]=[d("取消")])),_:1,__:[28]}),e(m,{type:"primary",onClick:le},{default:l(()=>t[29]||(t[29]=[d("确定")])),_:1,__:[29]})])]),default:l(()=>[e(J,{ref_key:"alertFormRef",ref:P,model:s,rules:W,"label-width":"100px"},{default:l(()=>[e(_,{label:"告警名称",prop:"name"},{default:l(()=>[e(E,{modelValue:s.name,"onUpdate:modelValue":t[6]||(t[6]=n=>s.name=n),placeholder:"请输入告警名称"},null,8,["modelValue"])]),_:1}),e(_,{label:"告警类型",prop:"type"},{default:l(()=>[e(L,{modelValue:s.type,"onUpdate:modelValue":t[7]||(t[7]=n=>s.type=n),placeholder:"请选择告警类型"},{default:l(()=>[e(c,{label:"CPU告警",value:"cpu"}),e(c,{label:"内存告警",value:"memory"}),e(c,{label:"存储告警",value:"storage"}),e(c,{label:"网络告警",value:"network"})]),_:1},8,["modelValue"])]),_:1}),e(_,{label:"告警级别",prop:"level"},{default:l(()=>[e(L,{modelValue:s.level,"onUpdate:modelValue":t[8]||(t[8]=n=>s.level=n),placeholder:"请选择告警级别"},{default:l(()=>[e(c,{label:"一般",value:"normal"}),e(c,{label:"警告",value:"warning"}),e(c,{label:"严重",value:"critical"})]),_:1},8,["modelValue"])]),_:1}),e(_,{label:"阈值",prop:"threshold"},{default:l(()=>[e(re,{modelValue:s.threshold,"onUpdate:modelValue":t[9]||(t[9]=n=>s.threshold=n),min:0,max:100},null,8,["modelValue"])]),_:1}),e(_,{label:"描述"},{default:l(()=>[e(E,{modelValue:s.description,"onUpdate:modelValue":t[10]||(t[10]=n=>s.description=n),type:"textarea"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}}),Ye=xe(Qe,[["__scopeId","data-v-e0e14252"]]);export{Ye as default};
