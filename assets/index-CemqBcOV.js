import{d as ee,r as d,a as $,D as te,c as B,b as s,e as t,w as n,f as i,i as le,j as r,t as _,J as ne,F as ae,n as oe,M as ie,E as D,o as U,m as se}from"./index-BJDuJlt9.js";import{_ as re}from"./_plugin-vue_export-helper-DlAUqK2U.js";const ue={class:"ticket-container"},de={class:"operation-bar"},pe={class:"pagination"},me={key:0},ce=ee({__name:"index",setup(fe){const b=d([{id:1,title:"主机故障报修",type:"故障报修",handler:"李明",status:"处理中",progress:2,createTime:"2025-04-01 09:00",logs:[{time:"2025-04-01 08:00",content:"工单已派单",type:"info"},{time:"2025-04-01 09:00",content:"正在处理",type:"warning"}]},{id:2,title:"网络巡检",type:"巡检",handler:"王芳",status:"已完成",progress:3,createTime:"2025-03-31 10:00",logs:[{time:"2025-03-31 09:00",content:"工单已派单",type:"info"},{time:"2025-03-31 10:00",content:"巡检完成",type:"success"}]},{id:3,title:"系统升级",type:"升级",handler:"赵强",status:"待处理",progress:1,createTime:"2025-03-30 14:00",logs:[{time:"2025-03-30 14:00",content:"工单已派单",type:"info"}]},{id:4,title:"打印机故障",type:"故障报修",handler:"孙丽",status:"处理中",progress:2,createTime:"2025-03-29 11:00",logs:[{time:"2025-03-29 10:00",content:"工单已派单",type:"info"},{time:"2025-03-29 11:00",content:"正在处理",type:"warning"}]},{id:5,title:"服务器巡检",type:"巡检",handler:"周伟",status:"已完成",progress:3,createTime:"2025-03-28 09:00",logs:[{time:"2025-03-28 08:00",content:"工单已派单",type:"info"},{time:"2025-03-28 09:00",content:"巡检完成",type:"success"}]},{id:6,title:"数据库升级",type:"升级",handler:"马俊",status:"待处理",progress:1,createTime:"2025-03-27 13:00",logs:[{time:"2025-03-27 13:00",content:"工单已派单",type:"info"}]},{id:7,title:"交换机故障",type:"故障报修",handler:"许静",status:"处理中",progress:2,createTime:"2025-03-26 10:00",logs:[{time:"2025-03-26 09:00",content:"工单已派单",type:"info"},{time:"2025-03-26 10:00",content:"正在处理",type:"warning"}]},{id:8,title:"办公区巡检",type:"巡检",handler:"宋倩",status:"已完成",progress:3,createTime:"2025-03-25 15:00",logs:[{time:"2025-03-25 14:00",content:"工单已派单",type:"info"},{time:"2025-03-25 15:00",content:"巡检完成",type:"success"}]},{id:9,title:"应用系统升级",type:"升级",handler:"魏东",status:"待处理",progress:1,createTime:"2025-03-24 16:00",logs:[{time:"2025-03-24 16:00",content:"工单已派单",type:"info"}]},{id:10,title:"门禁系统故障",type:"故障报修",handler:"冯媛",status:"处理中",progress:2,createTime:"2025-03-23 17:00",logs:[{time:"2025-03-23 16:00",content:"工单已派单",type:"info"},{time:"2025-03-23 17:00",content:"正在处理",type:"warning"}]}]),F=d([]),u=$({keyword:"",type:""}),k=d(1),T=d(10),q=d(0),V=d(!1),x=d("add"),z=d(),a=$({id:0,title:"",type:"",handler:"",status:"待处理",progress:1,createTime:"",logs:[]}),C=d(!1),p=d(null),j={title:[{required:!0,message:"请输入工单标题",trigger:"blur"}],type:[{required:!0,message:"请选择工单类型",trigger:"change"}],handler:[{required:!0,message:"请输入处理人",trigger:"blur"}],status:[{required:!0,message:"请选择状态",trigger:"change"}],createTime:[{required:!0,message:"请选择创建时间",trigger:"change"}]},m=()=>{let o=[...b.value];u.keyword&&(o=o.filter(e=>e.title.includes(u.keyword)||e.handler.includes(u.keyword))),u.type&&(o=o.filter(e=>e.type===u.type)),q.value=o.length,F.value=o.slice((k.value-1)*T.value,k.value*T.value)},I=()=>{u.keyword="",u.type="",k.value=1,m()},L=()=>{x.value="add",V.value=!0,a.id=0,a.title="",a.type="",a.handler="",a.status="待处理",a.progress=1,a.createTime="",a.logs=[]},R=o=>{x.value="edit",V.value=!0,Object.assign(a,o)},K=o=>{ie.confirm("确定要删除该工单吗？","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{const e=b.value.findIndex(y=>y.id===o.id);e!==-1&&(b.value.splice(e,1),m(),D.success("删除成功"))})},P=o=>{p.value=o,C.value=!0},A=async()=>{z.value&&await z.value.validate(o=>{if(o){if(x.value==="add"){const e={...a,id:Date.now(),logs:[{time:a.createTime,content:"工单已派单",type:"info"}]};b.value.unshift(e),m(),D.success("新增成功")}else{const e=b.value.findIndex(y=>y.id===a.id);e!==-1&&(b.value[e]={...a,id:a.id},m(),D.success("修改成功"))}V.value=!1}})},J=o=>{T.value=o,m()},O=o=>{k.value=o,m()};return te(()=>{m()}),(o,e)=>{const y=i("el-input"),f=i("el-form-item"),c=i("el-option"),S=i("el-select"),g=i("el-button"),E=i("el-form"),v=i("el-table-column"),G=i("el-tag"),w=i("el-step"),M=i("el-steps"),H=i("el-table"),Q=i("el-pagination"),W=i("el-card"),X=i("el-date-picker"),N=i("el-dialog"),Y=i("el-timeline-item"),Z=i("el-timeline");return U(),B("div",ue,[s("div",de,[t(E,{inline:!0,model:u,class:"search-form"},{default:n(()=>[t(f,null,{default:n(()=>[t(y,{modelValue:u.keyword,"onUpdate:modelValue":e[0]||(e[0]=l=>u.keyword=l),placeholder:"工单标题/处理人",clearable:"",onKeyup:le(m,["enter"])},null,8,["modelValue"])]),_:1}),t(f,null,{default:n(()=>[t(S,{modelValue:u.type,"onUpdate:modelValue":e[1]||(e[1]=l=>u.type=l),placeholder:"工单类型",clearable:"",style:{width:"120px"}},{default:n(()=>[t(c,{label:"故障报修",value:"故障报修"}),t(c,{label:"巡检",value:"巡检"}),t(c,{label:"升级",value:"升级"})]),_:1},8,["modelValue"])]),_:1}),t(f,null,{default:n(()=>[t(g,{type:"primary",onClick:m},{default:n(()=>e[12]||(e[12]=[r("搜索")])),_:1,__:[12]}),t(g,{onClick:I},{default:n(()=>e[13]||(e[13]=[r("重置")])),_:1,__:[13]})]),_:1})]),_:1},8,["model"])]),t(W,{class:"ticket-list"},{default:n(()=>[t(g,{type:"primary",link:"",onClick:L,style:{"margin-bottom":"12px"}},{default:n(()=>e[14]||(e[14]=[r("新增工单")])),_:1,__:[14]}),t(H,{data:F.value,border:"",style:{width:"100%"}},{default:n(()=>[t(v,{prop:"title",label:"工单标题","min-width":"140"}),t(v,{prop:"type",label:"工单类型","min-width":"100"}),t(v,{prop:"handler",label:"处理人","min-width":"100"}),t(v,{prop:"status",label:"状态","min-width":"100"},{default:n(({row:l})=>[t(G,{type:l.status==="已完成"?"success":l.status==="处理中"?"warning":"info"},{default:n(()=>[r(_(l.status),1)]),_:2},1032,["type"])]),_:1}),t(v,{label:"处理进度","min-width":"180"},{default:n(({row:l})=>[t(M,{active:l.progress,"finish-status":"success",simple:""},{default:n(()=>[t(w,{title:"已派单"}),t(w,{title:"处理中"}),t(w,{title:"已完成"})]),_:2},1032,["active"])]),_:1}),t(v,{prop:"createTime",label:"创建时间","min-width":"160"}),t(v,{label:"操作",width:"220"},{default:n(({row:l})=>[t(g,{type:"primary",link:"",onClick:h=>R(l)},{default:n(()=>e[15]||(e[15]=[r("编辑")])),_:2,__:[15]},1032,["onClick"]),t(g,{type:"danger",link:"",onClick:h=>K(l)},{default:n(()=>e[16]||(e[16]=[r("删除")])),_:2,__:[16]},1032,["onClick"]),t(g,{type:"info",link:"",onClick:h=>P(l)},{default:n(()=>e[17]||(e[17]=[r("详情")])),_:2,__:[17]},1032,["onClick"])]),_:1})]),_:1},8,["data"]),s("div",pe,[t(Q,{"current-page":k.value,"onUpdate:currentPage":e[2]||(e[2]=l=>k.value=l),"page-size":T.value,"onUpdate:pageSize":e[3]||(e[3]=l=>T.value=l),"page-sizes":[10,20,50,100],total:q.value,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:J,onCurrentChange:O},null,8,["current-page","page-size","total"])])]),_:1}),t(N,{modelValue:V.value,"onUpdate:modelValue":e[10]||(e[10]=l=>V.value=l),title:x.value==="add"?"新增工单":"编辑工单",width:"500px"},{footer:n(()=>[t(g,{onClick:e[9]||(e[9]=l=>V.value=!1)},{default:n(()=>e[18]||(e[18]=[r("取消")])),_:1,__:[18]}),t(g,{type:"primary",onClick:A},{default:n(()=>e[19]||(e[19]=[r("确定")])),_:1,__:[19]})]),default:n(()=>[t(E,{ref_key:"ticketFormRef",ref:z,model:a,rules:j,"label-width":"90px"},{default:n(()=>[t(f,{label:"工单标题",prop:"title"},{default:n(()=>[t(y,{modelValue:a.title,"onUpdate:modelValue":e[4]||(e[4]=l=>a.title=l),placeholder:"请输入工单标题"},null,8,["modelValue"])]),_:1}),t(f,{label:"工单类型",prop:"type"},{default:n(()=>[t(S,{modelValue:a.type,"onUpdate:modelValue":e[5]||(e[5]=l=>a.type=l),placeholder:"请选择工单类型",style:{width:"140px"}},{default:n(()=>[t(c,{label:"故障报修",value:"故障报修"}),t(c,{label:"巡检",value:"巡检"}),t(c,{label:"升级",value:"升级"})]),_:1},8,["modelValue"])]),_:1}),t(f,{label:"处理人",prop:"handler"},{default:n(()=>[t(y,{modelValue:a.handler,"onUpdate:modelValue":e[6]||(e[6]=l=>a.handler=l),placeholder:"请输入处理人"},null,8,["modelValue"])]),_:1}),t(f,{label:"状态",prop:"status"},{default:n(()=>[t(S,{modelValue:a.status,"onUpdate:modelValue":e[7]||(e[7]=l=>a.status=l),placeholder:"请选择状态",style:{width:"140px"}},{default:n(()=>[t(c,{label:"待处理",value:"待处理"}),t(c,{label:"处理中",value:"处理中"}),t(c,{label:"已完成",value:"已完成"})]),_:1},8,["modelValue"])]),_:1}),t(f,{label:"创建时间",prop:"createTime"},{default:n(()=>[t(X,{modelValue:a.createTime,"onUpdate:modelValue":e[8]||(e[8]=l=>a.createTime=l),type:"datetime",placeholder:"选择时间",style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"]),t(N,{modelValue:C.value,"onUpdate:modelValue":e[11]||(e[11]=l=>C.value=l),title:"工单详情",width:"600px","before-close":()=>C.value=!1},{default:n(()=>[p.value?(U(),B("div",me,[s("p",null,[e[20]||(e[20]=s("b",null,"工单标题：",-1)),r(_(p.value.title),1)]),s("p",null,[e[21]||(e[21]=s("b",null,"工单类型：",-1)),r(_(p.value.type),1)]),s("p",null,[e[22]||(e[22]=s("b",null,"处理人：",-1)),r(_(p.value.handler),1)]),s("p",null,[e[23]||(e[23]=s("b",null,"状态：",-1)),r(_(p.value.status),1)]),s("p",null,[e[24]||(e[24]=s("b",null,"创建时间：",-1)),r(_(p.value.createTime),1)]),e[25]||(e[25]=s("p",null,[s("b",null,"处理进度：")],-1)),t(M,{active:p.value.progress,"finish-status":"success"},{default:n(()=>[t(w,{title:"已派单"}),t(w,{title:"处理中"}),t(w,{title:"已完成"})]),_:1},8,["active"]),e[26]||(e[26]=s("p",{style:{"margin-top":"16px"}},[s("b",null,"处理记录：")],-1)),t(Z,null,{default:n(()=>[(U(!0),B(ae,null,oe(p.value.logs,(l,h)=>(U(),se(Y,{key:h,timestamp:l.time,type:l.type},{default:n(()=>[r(_(l.content),1)]),_:2},1032,["timestamp","type"]))),128))]),_:1})])):ne("",!0)]),_:1},8,["modelValue","before-close"])])}}}),ve=re(ce,[["__scopeId","data-v-37c41dfa"]]);export{ve as default};
