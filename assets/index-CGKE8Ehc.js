import{d as Ue,a as le,r,v as Re,D as $e,c as I,b,m as C,J as x,e as l,w as t,f as u,i as Be,F as te,n as ae,j as s,g as N,K as ne,L as De,t as R,M as $,E as v,o as g}from"./index-Du8AeyGt.js";import{_ as Pe}from"./_plugin-vue_export-helper-DlAUqK2U.js";const Se={class:"user-container"},Ee={class:"operation-bar"},Fe={class:"operation-buttons"},je={class:"table-actions"},Me={class:"pagination"},qe={class:"dialog-footer"},Ie={class:"role-operation"},Ne={class:"table-actions"},Ke=Ue({__name:"index",setup(Oe){const o=le({keyword:"",role:"",status:""}),B=[{label:"系统管理员",value:"系统管理员"},{label:"运维管理员",value:"运维管理员"},{label:"部门管理员",value:"部门管理员"},{label:"普通用户",value:"普通用户"}],_=[{id:1,username:"admin",name:"张建国",phone:"13953701245",email:"zhangjg@yanzhou.gov.cn",department:"信息化办公室",position:"主任",role:"系统管理员",status:"active",lastLogin:"2024-03-20 08:30:00",createTime:"2023-01-01"},{id:2,username:"liwei",name:"李伟",phone:"13853712561",email:"liwei@yanzhou.gov.cn",department:"信息化办公室",position:"副主任",role:"运维管理员",status:"active",lastLogin:"2024-03-20 09:15:00",createTime:"2023-01-15"},{id:3,username:"wangfang",name:"王芳",phone:"1375372389",email:"wangfang@yanzhou.gov.cn",department:"信息化办公室",position:"科员",role:"普通用户",status:"inactive",lastLogin:"2024-03-19 16:45:00",createTime:"2023-02-01"},{id:4,username:"zhaoming",name:"赵明",phone:"13653734576",email:"zhaoming@yanzhou.gov.cn",department:"政务服务中心",position:"主任",role:"部门管理员",status:"active",lastLogin:"2024-03-20 10:20:00",createTime:"2023-02-15"},{id:5,username:"chenjing",name:"陈静",phone:"13553745652",email:"chenjing@yanzhou.gov.cn",department:"政务服务中心",position:"科员",role:"普通用户",status:"inactive",lastLogin:"2024-03-19 14:30:00",createTime:"2023-03-01"},{id:6,username:"liuhong",name:"刘红",phone:"13453756984",email:"liuhong@yanzhou.gov.cn",department:"经济发展局",position:"主任",role:"部门管理员",status:"active",lastLogin:"2024-03-20 11:15:00",createTime:"2023-03-15"},{id:7,username:"yangwei",name:"杨伟",phone:"13353767690",email:"yangwei@yanzhou.gov.cn",department:"经济发展局",position:"科员",role:"普通用户",status:"active",lastLogin:"2024-03-19 15:45:00",createTime:"2023-04-01"},{id:8,username:"zhangli",name:"张力",phone:"13253778901",email:"zhangli@yanzhou.gov.cn",department:"社会事务局",position:"主任",role:"部门管理员",status:"inactive",lastLogin:"2024-03-20 13:20:00",createTime:"2023-04-15"},{id:9,username:"wanghua",name:"王华",phone:"13153789012",email:"wanghua@yanzhou.gov.cn",department:"社会事务局",position:"科员",role:"普通用户",status:"active",lastLogin:"2024-03-19 17:30:00",createTime:"2023-05-01"},{id:10,username:"lixia",name:"李霞",phone:"13053790123",email:"lixia@yanzhou.gov.cn",department:"信息化办公室",position:"科员",role:"普通用户",status:"inactive",lastLogin:"2024-03-20 14:45:00",createTime:"2023-05-15"}],K=r([]),y=r(1),h=r(10),D=r(100),k=r(!1),T=r("add"),P=r(),i=le({id:0,username:"",name:"",phone:"",email:"",department:"",position:"",role:"",status:"正常",lastLogin:"",createTime:""}),S=r(!1),E=r("list"),z=r([]),oe=r(),O=r([{id:1,name:"系统管理",children:[{id:11,name:"用户管理"},{id:12,name:"角色管理"},{id:13,name:"权限管理"}]},{id:2,name:"设备管理",children:[{id:21,name:"设备列表"},{id:22,name:"设备监控"},{id:23,name:"设备维护"}]}]),A=r([11,21]),J=n=>{const e=B.find(p=>p.value===n);return e?e.label:n},c=()=>{let n=[..._];o.keyword&&(n=n.filter(e=>e.username.includes(o.keyword)||e.phone.includes(o.keyword))),o.role&&(n=n.filter(e=>e.role===o.role)),o.status&&(n=n.filter(e=>e.status===o.status)),D.value=n.length,K.value=n.slice((y.value-1)*h.value,y.value*h.value)},G=()=>{o.keyword="",o.role="",o.status="",y.value=1,c()},se=()=>{T.value="add",k.value=!0,Object.assign(i,{id:Date.now(),username:"",name:"",phone:"",email:"",department:"",position:"",role:"",status:"正常",lastLogin:"",createTime:""})},ie=n=>{T.value="edit",k.value=!0,Object.assign(i,n)},ue=n=>{$.confirm("确定要删除该用户吗？","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{const e=_.findIndex(p=>p.id===n.id);e!==-1&&(_.splice(e,1),c(),v.success("删除成功"),D.value=_.length)})},re=n=>{n.status=n.status==="active"?"inactive":"active";const e=n.status==="active"?"启用":"禁用";v.success(`已${e}用户：${n.username}`)},de=async()=>{P.value&&await P.value.validate(n=>{if(n){if(T.value==="add"){const e={...i,id:Date.now(),createTime:new Date().toLocaleString(),lastLogin:""};_.unshift(e),c(),v.success("新增成功")}else{const e=_.findIndex(p=>p.id===i.id);e!==-1&&(_[e]={...i,id:i.id,createTime:i.createTime,lastLogin:i.lastLogin},c(),v.success("修改成功"))}k.value=!1}})},me=n=>{h.value=n,c()},pe=n=>{y.value=n,c()},ce=()=>{S.value=!0},fe=()=>{$.prompt("请输入新角色名称","新增角色",{confirmButtonText:"确定",cancelButtonText:"取消",inputPattern:/^.{2,20}$/,inputErrorMessage:"角色名称长度为2-20个字符"}).then(({value:n})=>{const e={id:Date.now(),name:n,description:"",permissions:[],createTime:new Date().toLocaleString()};z.value.push(e),v.success("新增角色成功")})},ve=n=>{$.prompt("请输入新的角色名称","编辑角色",{confirmButtonText:"确定",cancelButtonText:"取消",inputValue:n.name,inputPattern:/^.{2,20}$/,inputErrorMessage:"角色名称长度为2-20个字符"}).then(({value:e})=>{n.name=e,v.success("编辑角色成功")})},ge=n=>{$.confirm("确定要删除该角色吗？","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{const e=z.value.findIndex(p=>p.id===n.id);e!==-1&&(z.value.splice(e,1),v.success("删除成功"))})},_e=n=>{E.value="permission",A.value=[11,21],v.info(`为角色【${n.name}】分配权限（仅模拟）`)},V=r(!1),ye=r([]),be=r(null),H=r(),ke=n=>{var e;be.value=n.id,(e=H.value)==null||e.setCheckedKeys(["1","1-1","1-2"]),V.value=!0},he=()=>{v.success("权限已保存（仅模拟）"),V.value=!1},Q=Re(()=>!!o.role||!!o.status||!!o.keyword),F=n=>{o[n]="",y.value=1,c()},Ve={username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:3,max:20,message:"长度在 3 到 20 个字符",trigger:"blur"}],name:[{required:!0,message:"请输入姓名",trigger:"blur"}],phone:[{required:!0,message:"请输入手机号",trigger:"blur"},{pattern:/^1[3-9]\d{9}$/,message:"请输入正确的手机号",trigger:"blur"}],email:[{required:!0,message:"请输入邮箱",trigger:"blur"},{type:"email",message:"请输入正确的邮箱地址",trigger:"blur"}],role:[{required:!0,message:"请选择角色",trigger:"change"}]};return $e(()=>{c()}),(n,e)=>{const p=u("el-input"),f=u("el-form-item"),L=u("el-option"),j=u("el-select"),d=u("el-button"),W=u("el-form"),M=u("el-icon"),U=u("el-tag"),we=u("el-row"),m=u("el-table-column"),Ce=u("el-switch"),X=u("el-table"),xe=u("el-pagination"),Te=u("el-card"),Y=u("el-radio"),ze=u("el-radio-group"),q=u("el-dialog"),Z=u("el-tree"),ee=u("el-tab-pane"),Le=u("el-tabs");return g(),I("div",Se,[b("div",Ee,[l(W,{inline:!0,model:o,class:"search-form"},{default:t(()=>[l(f,null,{default:t(()=>[l(p,{modelValue:o.keyword,"onUpdate:modelValue":e[0]||(e[0]=a=>o.keyword=a),placeholder:"用户名/手机号",clearable:"",onKeyup:Be(c,["enter"])},null,8,["modelValue"])]),_:1}),l(f,null,{default:t(()=>[l(j,{modelValue:o.role,"onUpdate:modelValue":e[1]||(e[1]=a=>o.role=a),placeholder:"角色",clearable:"",style:{width:"140px"}},{default:t(()=>[(g(),I(te,null,ae(B,a=>l(L,{key:a.value,label:a.label,value:a.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),l(f,null,{default:t(()=>[l(j,{modelValue:o.status,"onUpdate:modelValue":e[2]||(e[2]=a=>o.status=a),placeholder:"状态",clearable:"",style:{width:"140px"}},{default:t(()=>[l(L,{label:"启用",value:"active"}),l(L,{label:"禁用",value:"inactive"})]),_:1},8,["modelValue"])]),_:1}),l(f,null,{default:t(()=>[l(d,{type:"primary",onClick:c},{default:t(()=>e[20]||(e[20]=[s("搜索")])),_:1,__:[20]}),l(d,{onClick:G},{default:t(()=>e[21]||(e[21]=[s("重置")])),_:1,__:[21]})]),_:1})]),_:1},8,["model"]),b("div",Fe,[l(d,{type:"primary",onClick:se},{default:t(()=>[l(M,null,{default:t(()=>[l(N(ne))]),_:1}),e[22]||(e[22]=s("新增用户 "))]),_:1,__:[22]}),l(d,{type:"success",onClick:ce},{default:t(()=>[l(M,null,{default:t(()=>[l(N(De))]),_:1}),e[23]||(e[23]=s("角色管理 "))]),_:1,__:[23]})])]),Q.value?(g(),C(we,{key:0,class:"filter-tags",style:{"margin-bottom":"10px"}},{default:t(()=>[o.role?(g(),C(U,{key:0,type:"info",closable:"",onClose:e[3]||(e[3]=()=>F("role"))},{default:t(()=>[s(" 角色："+R(J(o.role)),1)]),_:1})):x("",!0),o.status?(g(),C(U,{key:1,type:"info",closable:"",onClose:e[4]||(e[4]=()=>F("status"))},{default:t(()=>[s(" 状态："+R(o.status==="active"?"启用":"禁用"),1)]),_:1})):x("",!0),o.keyword?(g(),C(U,{key:2,type:"info",closable:"",onClose:e[5]||(e[5]=()=>F("keyword"))},{default:t(()=>[s(" 关键词："+R(o.keyword),1)]),_:1})):x("",!0),Q.value?(g(),C(d,{key:3,size:"small",type:"text",onClick:G},{default:t(()=>e[24]||(e[24]=[s("清除全部")])),_:1,__:[24]})):x("",!0)]),_:1})):x("",!0),l(Te,{class:"user-list"},{default:t(()=>[l(X,{data:K.value,border:"",style:{width:"100%"}},{default:t(()=>[l(m,{type:"selection",width:"55"}),l(m,{prop:"username",label:"用户名","min-width":"120"}),l(m,{prop:"name",label:"姓名","min-width":"120"}),l(m,{prop:"phone",label:"手机号","min-width":"120"}),l(m,{prop:"email",label:"邮箱","min-width":"180"}),l(m,{prop:"role",label:"角色","min-width":"120"},{default:t(({row:a})=>[l(U,{type:a.role==="系统管理员"?"danger":a.role==="运维管理员"?"warning":"info"},{default:t(()=>[s(R(J(a.role)),1)]),_:2},1032,["type"])]),_:1}),l(m,{prop:"status",label:"状态",width:"100"},{default:t(({row:a})=>[l(Ce,{"model-value":a.status,"active-value":"active","inactive-value":"inactive",onClick:()=>re(a)},null,8,["model-value","onClick"])]),_:1}),l(m,{prop:"createTime",label:"创建时间","min-width":"180"}),l(m,{label:"操作",width:"300"},{default:t(({row:a})=>[b("div",je,[l(d,{type:"primary",link:"",onClick:w=>ie(a)},{default:t(()=>e[25]||(e[25]=[s("编辑")])),_:2,__:[25]},1032,["onClick"]),l(d,{type:"primary",link:"",onClick:w=>ke(a)},{default:t(()=>e[26]||(e[26]=[s("权限")])),_:2,__:[26]},1032,["onClick"]),l(d,{type:"danger",link:"",onClick:w=>ue(a)},{default:t(()=>e[27]||(e[27]=[s("删除")])),_:2,__:[27]},1032,["onClick"])])]),_:1})]),_:1},8,["data"]),b("div",Me,[l(xe,{"current-page":y.value,"onUpdate:currentPage":e[6]||(e[6]=a=>y.value=a),"page-size":h.value,"onUpdate:pageSize":e[7]||(e[7]=a=>h.value=a),"page-sizes":[10,20,50,100],total:D.value,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:me,onCurrentChange:pe},null,8,["current-page","page-size","total"])])]),_:1}),l(q,{modelValue:k.value,"onUpdate:modelValue":e[15]||(e[15]=a=>k.value=a),title:T.value==="add"?"新增用户":"编辑用户",width:"500px"},{footer:t(()=>[b("span",qe,[l(d,{onClick:e[14]||(e[14]=a=>k.value=!1)},{default:t(()=>e[30]||(e[30]=[s("取消")])),_:1,__:[30]}),l(d,{type:"primary",onClick:de},{default:t(()=>e[31]||(e[31]=[s("确定")])),_:1,__:[31]})])]),default:t(()=>[l(W,{ref_key:"userFormRef",ref:P,model:i,rules:Ve,"label-width":"80px"},{default:t(()=>[l(f,{label:"用户名",prop:"username"},{default:t(()=>[l(p,{modelValue:i.username,"onUpdate:modelValue":e[8]||(e[8]=a=>i.username=a),placeholder:"请输入用户名"},null,8,["modelValue"])]),_:1}),l(f,{label:"姓名",prop:"name"},{default:t(()=>[l(p,{modelValue:i.name,"onUpdate:modelValue":e[9]||(e[9]=a=>i.name=a),placeholder:"请输入姓名"},null,8,["modelValue"])]),_:1}),l(f,{label:"手机号",prop:"phone"},{default:t(()=>[l(p,{modelValue:i.phone,"onUpdate:modelValue":e[10]||(e[10]=a=>i.phone=a),placeholder:"请输入手机号"},null,8,["modelValue"])]),_:1}),l(f,{label:"邮箱",prop:"email"},{default:t(()=>[l(p,{modelValue:i.email,"onUpdate:modelValue":e[11]||(e[11]=a=>i.email=a),placeholder:"请输入邮箱"},null,8,["modelValue"])]),_:1}),l(f,{label:"角色",prop:"role"},{default:t(()=>[l(j,{modelValue:i.role,"onUpdate:modelValue":e[12]||(e[12]=a=>i.role=a),placeholder:"请选择角色"},{default:t(()=>[(g(),I(te,null,ae(B,a=>l(L,{key:a.value,label:a.label,value:a.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),l(f,{label:"状态",prop:"status"},{default:t(()=>[l(ze,{modelValue:i.status,"onUpdate:modelValue":e[13]||(e[13]=a=>i.status=a)},{default:t(()=>[l(Y,{label:"active"},{default:t(()=>e[28]||(e[28]=[s("启用")])),_:1,__:[28]}),l(Y,{label:"inactive"},{default:t(()=>e[29]||(e[29]=[s("禁用")])),_:1,__:[29]})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"]),l(q,{modelValue:V.value,"onUpdate:modelValue":e[17]||(e[17]=a=>V.value=a),title:"分配权限",width:"400px"},{footer:t(()=>[l(d,{onClick:e[16]||(e[16]=a=>V.value=!1)},{default:t(()=>e[32]||(e[32]=[s("取消")])),_:1,__:[32]}),l(d,{type:"primary",onClick:he},{default:t(()=>e[33]||(e[33]=[s("保存")])),_:1,__:[33]})]),default:t(()=>[l(Z,{data:O.value,"show-checkbox":"","node-key":"id","default-checked-keys":ye.value,props:{label:"name",children:"children"},ref_key:"userPermissionTreeRef",ref:H},null,8,["data","default-checked-keys"])]),_:1},8,["modelValue"]),l(q,{modelValue:S.value,"onUpdate:modelValue":e[19]||(e[19]=a=>S.value=a),title:"角色管理",width:"800px"},{default:t(()=>[l(Le,{modelValue:E.value,"onUpdate:modelValue":e[18]||(e[18]=a=>E.value=a)},{default:t(()=>[l(ee,{label:"角色列表",name:"list"},{default:t(()=>[b("div",Ie,[l(d,{type:"primary",onClick:fe},{default:t(()=>[l(M,null,{default:t(()=>[l(N(ne))]),_:1}),e[34]||(e[34]=s("新增角色 "))]),_:1,__:[34]})]),l(X,{data:z.value,border:"",style:{width:"100%"}},{default:t(()=>[l(m,{prop:"name",label:"角色名称"}),l(m,{prop:"code",label:"角色编码"}),l(m,{prop:"description",label:"描述"}),l(m,{prop:"createTime",label:"创建时间"}),l(m,{label:"操作",width:"200"},{default:t(({row:a})=>[b("div",Ne,[l(d,{type:"primary",link:"",onClick:w=>ve(a)},{default:t(()=>e[35]||(e[35]=[s("编辑")])),_:2,__:[35]},1032,["onClick"]),l(d,{type:"primary",link:"",onClick:w=>_e(a)},{default:t(()=>e[36]||(e[36]=[s("权限")])),_:2,__:[36]},1032,["onClick"]),l(d,{type:"danger",link:"",onClick:w=>ge(a)},{default:t(()=>e[37]||(e[37]=[s("删除")])),_:2,__:[37]},1032,["onClick"])])]),_:1})]),_:1},8,["data"])]),_:1}),l(ee,{label:"权限配置",name:"permission"},{default:t(()=>[l(Z,{ref_key:"permissionTreeRef",ref:oe,data:O.value,"show-checkbox":"","node-key":"id","default-checked-keys":A.value,props:{label:"name",children:"children"}},null,8,["data","default-checked-keys"])]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["modelValue"])])}}}),Ge=Pe(Ke,[["__scopeId","data-v-7c76905e"]]);export{Ge as default};
