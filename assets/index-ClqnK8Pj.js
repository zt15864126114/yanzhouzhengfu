import{d as te,r as p,A as $,e as re,j as l,b as a,a as d,l as se,B as ne,c as F,q as n,t as h,k as f,m as w,C as de,D as ue,E as ie,G as me,s as pe,H as fe,I as ge,J as v,o as B}from"./index-DJATdj55.js";import{_ as _e}from"./_plugin-vue_export-helper-DlAUqK2U.js";const be={class:"user-container"},ce={class:"card-header"},ve={class:"header-right"},Ve={class:"action-buttons"},ye={class:"dialog-footer"},ke={class:"verify-code"},we={class:"dialog-footer"},xe={class:"dialog-footer"},Ce=te({__name:"index",setup(Te){const M=p(!1),P=p([{id:1,username:"admin",role:"admin",phone:"13800138000",email:"admin@example.com",status:"active",createTime:"2024-01-01 12:00:00"},{id:2,username:"operator",role:"operator",phone:"13800138001",email:"operator@example.com",status:"active",createTime:"2024-01-02 12:00:00"},{id:3,username:"system",role:"admin",phone:"13800138002",email:"system@example.com",status:"active",createTime:"2024-01-03 12:00:00"},{id:4,username:"monitor",role:"operator",phone:"13800138003",email:"monitor@example.com",status:"active",createTime:"2024-01-04 12:00:00"},{id:5,username:"security",role:"admin",phone:"13800138004",email:"security@example.com",status:"active",createTime:"2024-01-05 12:00:00"},{id:6,username:"backup",role:"operator",phone:"13800138005",email:"backup@example.com",status:"inactive",createTime:"2024-01-06 12:00:00"},{id:7,username:"test",role:"user",phone:"13800138006",email:"test@example.com",status:"active",createTime:"2024-01-07 12:00:00"},{id:8,username:"guest",role:"user",phone:"13800138007",email:"guest@example.com",status:"inactive",createTime:"2024-01-08 12:00:00"}]),c=p(!1),V=p("add"),x=p(),s=$({username:"",password:"",phone:"",email:"",role:""}),z={username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:3,max:20,message:"长度在 3 到 20 个字符",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,max:20,message:"长度在 6 到 20 个字符",trigger:"blur"},{pattern:/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)[^]{6,20}$/,message:"密码必须包含大小写字母和数字",trigger:"blur"}],phone:[{required:!0,message:"请输入手机号",trigger:"blur"},{pattern:/^1[3-9]\d{9}$/,message:"请输入正确的手机号",trigger:"blur"}],email:[{required:!0,message:"请输入邮箱",trigger:"blur"},{type:"email",message:"请输入正确的邮箱地址",trigger:"blur"}],role:[{required:!0,message:"请选择角色",trigger:"change"}]},y=p(!1),C=p(),t=$({username:"",password:"",confirmPassword:"",phone:"",email:"",code:""}),N={username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:3,max:20,message:"长度在 3 到 20 个字符",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,max:20,message:"长度在 6 到 20 个字符",trigger:"blur"},{pattern:/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)[^]{6,20}$/,message:"密码必须包含大小写字母和数字",trigger:"blur"}],confirmPassword:[{required:!0,message:"请确认密码",trigger:"blur"},{validator:(r,e,_)=>{e!==t.password?_(new Error("两次输入的密码不一致")):_()},trigger:"blur"}],phone:[{required:!0,message:"请输入手机号",trigger:"blur"},{pattern:/^1[3-9]\d{9}$/,message:"请输入正确的手机号",trigger:"blur"}],email:[{required:!0,message:"请输入邮箱",trigger:"blur"},{type:"email",message:"请输入正确的邮箱地址",trigger:"blur"}],code:[{required:!0,message:"请输入验证码",trigger:"blur"},{len:6,message:"验证码长度为6位",trigger:"blur"}]},k=p(!1),S=p(),g=$({username:"",roles:[],permissions:[]}),A=[{id:"1",label:"系统管理",children:[{id:"1-1",label:"用户管理"},{id:"1-2",label:"角色管理"},{id:"1-3",label:"权限管理"}]},{id:"2",label:"设备管理",children:[{id:"2-1",label:"设备列表"},{id:"2-2",label:"设备监控"},{id:"2-3",label:"设备配置"}]},{id:"3",label:"资源管理",children:[{id:"3-1",label:"资源分配"},{id:"3-2",label:"资源监控"},{id:"3-3",label:"资源统计"}]}],j=r=>({admin:"danger",operator:"warning",user:"info"})[r]||"info",I=r=>({admin:"管理员",operator:"操作员",user:"普通用户"})[r]||r,Z=()=>{V.value="add",c.value=!0,s.username="",s.password="",s.phone="",s.email="",s.role=""},G=r=>{V.value="edit",c.value=!0,Object.assign(s,r)},H=r=>{ge.confirm(`确认删除用户"${r.username}"吗？`,"警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{v.success(`用户"${r.username}"已删除`)})},J=async()=>{x.value&&await x.value.validate(r=>{r&&(c.value=!1,v.success(V.value==="add"?"添加成功":"修改成功"))})},L=()=>{y.value=!0,t.username="",t.password="",t.confirmPassword="",t.phone="",t.email="",t.code=""},O=()=>{if(!t.phone){v.warning("请先输入手机号");return}v.success("验证码已发送")},K=async()=>{C.value&&await C.value.validate(r=>{r&&(y.value=!1,v.success("注册成功，请查收激活邮件"))})},Q=r=>{k.value=!0,g.username=r.username,g.roles=[r.role],g.permissions=[]},W=()=>{k.value=!1,v.success("角色分配成功")};return(r,e)=>{const _=d("el-icon"),i=d("el-button"),b=d("el-table-column"),D=d("el-tag"),X=d("el-table"),Y=d("el-card"),m=d("el-input"),u=d("el-form-item"),T=d("el-option"),ee=d("el-select"),U=d("el-form"),R=d("el-dialog"),q=d("el-checkbox"),le=d("el-checkbox-group"),ae=d("el-tree"),oe=ne("loading");return B(),re("div",be,[l(Y,null,{header:a(()=>[f("div",ce,[e[20]||(e[20]=f("span",null,"用户管理",-1)),f("div",ve,[l(i,{type:"primary",onClick:Z},{default:a(()=>[l(_,null,{default:a(()=>[l(w(me))]),_:1}),e[18]||(e[18]=n("添加用户 "))]),_:1,__:[18]}),l(i,{type:"success",onClick:L},{default:a(()=>[l(_,null,{default:a(()=>[l(w(pe))]),_:1}),e[19]||(e[19]=n("用户注册 "))]),_:1,__:[19]})])])]),default:a(()=>[se((B(),F(X,{data:P.value,style:{width:"100%"}},{default:a(()=>[l(b,{prop:"username",label:"用户名"}),l(b,{prop:"role",label:"角色"},{default:a(({row:o})=>[l(D,{type:j(o.role)},{default:a(()=>[n(h(I(o.role)),1)]),_:2},1032,["type"])]),_:1}),l(b,{prop:"phone",label:"手机号"}),l(b,{prop:"email",label:"邮箱"}),l(b,{prop:"status",label:"状态"},{default:a(({row:o})=>[l(D,{type:o.status==="active"?"success":"info"},{default:a(()=>[n(h(o.status==="active"?"已激活":"未激活"),1)]),_:2},1032,["type"])]),_:1}),l(b,{prop:"createTime",label:"创建时间"}),l(b,{label:"操作",width:"300"},{default:a(({row:o})=>[f("div",Ve,[l(i,{class:"action-btn",size:"small",type:"primary",onClick:E=>G(o)},{default:a(()=>[l(_,null,{default:a(()=>[l(w(de))]),_:1}),e[21]||(e[21]=n("编辑 "))]),_:2,__:[21]},1032,["onClick"]),l(i,{class:"action-btn",size:"small",type:"success",onClick:E=>Q(o)},{default:a(()=>[l(_,null,{default:a(()=>[l(w(ue))]),_:1}),e[22]||(e[22]=n("分配角色 "))]),_:2,__:[22]},1032,["onClick"]),l(i,{class:"action-btn",size:"small",type:"danger",onClick:E=>H(o)},{default:a(()=>[l(_,null,{default:a(()=>[l(w(ie))]),_:1}),e[23]||(e[23]=n("删除 "))]),_:2,__:[23]},1032,["onClick"])])]),_:1})]),_:1},8,["data"])),[[oe,M.value]])]),_:1}),l(R,{modelValue:c.value,"onUpdate:modelValue":e[6]||(e[6]=o=>c.value=o),title:V.value==="add"?"添加用户":"编辑用户",width:"500px"},{footer:a(()=>[f("span",ye,[l(i,{onClick:e[5]||(e[5]=o=>c.value=!1)},{default:a(()=>e[24]||(e[24]=[n("取消")])),_:1,__:[24]}),l(i,{type:"primary",onClick:J},{default:a(()=>e[25]||(e[25]=[n("确定")])),_:1,__:[25]})])]),default:a(()=>[l(U,{ref_key:"formRef",ref:x,model:s,rules:z,"label-width":"100px"},{default:a(()=>[l(u,{label:"用户名",prop:"username"},{default:a(()=>[l(m,{modelValue:s.username,"onUpdate:modelValue":e[0]||(e[0]=o=>s.username=o),placeholder:"请输入用户名"},null,8,["modelValue"])]),_:1}),V.value==="add"?(B(),F(u,{key:0,label:"密码",prop:"password"},{default:a(()=>[l(m,{modelValue:s.password,"onUpdate:modelValue":e[1]||(e[1]=o=>s.password=o),type:"password",placeholder:"请输入密码"},null,8,["modelValue"])]),_:1})):fe("",!0),l(u,{label:"手机号",prop:"phone"},{default:a(()=>[l(m,{modelValue:s.phone,"onUpdate:modelValue":e[2]||(e[2]=o=>s.phone=o),placeholder:"请输入手机号"},null,8,["modelValue"])]),_:1}),l(u,{label:"邮箱",prop:"email"},{default:a(()=>[l(m,{modelValue:s.email,"onUpdate:modelValue":e[3]||(e[3]=o=>s.email=o),placeholder:"请输入邮箱"},null,8,["modelValue"])]),_:1}),l(u,{label:"角色",prop:"role"},{default:a(()=>[l(ee,{modelValue:s.role,"onUpdate:modelValue":e[4]||(e[4]=o=>s.role=o),placeholder:"请选择角色"},{default:a(()=>[l(T,{label:"普通用户",value:"user"}),l(T,{label:"操作员",value:"operator"}),l(T,{label:"管理员",value:"admin"})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"]),l(R,{modelValue:y.value,"onUpdate:modelValue":e[14]||(e[14]=o=>y.value=o),title:"用户注册",width:"500px"},{footer:a(()=>[f("span",we,[l(i,{onClick:e[13]||(e[13]=o=>y.value=!1)},{default:a(()=>e[27]||(e[27]=[n("取消")])),_:1,__:[27]}),l(i,{type:"primary",onClick:K},{default:a(()=>e[28]||(e[28]=[n("注册")])),_:1,__:[28]})])]),default:a(()=>[l(U,{ref_key:"registerFormRef",ref:C,model:t,rules:N,"label-width":"100px"},{default:a(()=>[l(u,{label:"用户名",prop:"username"},{default:a(()=>[l(m,{modelValue:t.username,"onUpdate:modelValue":e[7]||(e[7]=o=>t.username=o),placeholder:"请输入用户名"},null,8,["modelValue"])]),_:1}),l(u,{label:"密码",prop:"password"},{default:a(()=>[l(m,{modelValue:t.password,"onUpdate:modelValue":e[8]||(e[8]=o=>t.password=o),type:"password",placeholder:"请输入密码"},null,8,["modelValue"])]),_:1}),l(u,{label:"确认密码",prop:"confirmPassword"},{default:a(()=>[l(m,{modelValue:t.confirmPassword,"onUpdate:modelValue":e[9]||(e[9]=o=>t.confirmPassword=o),type:"password",placeholder:"请确认密码"},null,8,["modelValue"])]),_:1}),l(u,{label:"手机号",prop:"phone"},{default:a(()=>[l(m,{modelValue:t.phone,"onUpdate:modelValue":e[10]||(e[10]=o=>t.phone=o),placeholder:"请输入手机号"},null,8,["modelValue"])]),_:1}),l(u,{label:"邮箱",prop:"email"},{default:a(()=>[l(m,{modelValue:t.email,"onUpdate:modelValue":e[11]||(e[11]=o=>t.email=o),placeholder:"请输入邮箱"},null,8,["modelValue"])]),_:1}),l(u,{label:"验证码",prop:"code"},{default:a(()=>[f("div",ke,[l(m,{modelValue:t.code,"onUpdate:modelValue":e[12]||(e[12]=o=>t.code=o),placeholder:"请输入验证码"},null,8,["modelValue"]),l(i,{type:"primary",onClick:O},{default:a(()=>e[26]||(e[26]=[n("获取验证码")])),_:1,__:[26]})])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),l(R,{modelValue:k.value,"onUpdate:modelValue":e[17]||(e[17]=o=>k.value=o),title:"分配角色",width:"500px"},{footer:a(()=>[f("span",xe,[l(i,{onClick:e[16]||(e[16]=o=>k.value=!1)},{default:a(()=>e[32]||(e[32]=[n("取消")])),_:1,__:[32]}),l(i,{type:"primary",onClick:W},{default:a(()=>e[33]||(e[33]=[n("确定")])),_:1,__:[33]})])]),default:a(()=>[l(U,{ref_key:"roleFormRef",ref:S,model:g,"label-width":"100px"},{default:a(()=>[l(u,{label:"用户名"},{default:a(()=>[f("span",null,h(g.username),1)]),_:1}),l(u,{label:"角色"},{default:a(()=>[l(le,{modelValue:g.roles,"onUpdate:modelValue":e[15]||(e[15]=o=>g.roles=o)},{default:a(()=>[l(q,{label:"user"},{default:a(()=>e[29]||(e[29]=[n("普通用户")])),_:1,__:[29]}),l(q,{label:"operator"},{default:a(()=>e[30]||(e[30]=[n("操作员")])),_:1,__:[30]}),l(q,{label:"admin"},{default:a(()=>e[31]||(e[31]=[n("管理员")])),_:1,__:[31]})]),_:1},8,["modelValue"])]),_:1}),l(u,{label:"权限"},{default:a(()=>[l(ae,{ref:"permissionTreeRef",data:A,"show-checkbox":"","node-key":"id","default-checked-keys":g.permissions},null,8,["default-checked-keys"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}}),qe=_e(Ce,[["__scopeId","data-v-9e7807fd"]]);export{qe as default};
