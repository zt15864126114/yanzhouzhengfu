import{d as W,r as i,a as U,D as X,R as Y,c as Z,b as d,e as t,w as l,f as n,t as x,i as ee,j as v,M as te,E as z,o as le}from"./index-8ff_kA6S.js";import{i as ae}from"./index-BjzP5g9D.js";import{_ as se}from"./_plugin-vue_export-helper-DlAUqK2U.js";const oe={class:"health-container"},ne={class:"health-stats"},re={class:"stat-value normal"},de={class:"stat-value error"},ie={class:"stat-value warning"},ue={class:"operation-bar"},ce={class:"pagination"},me=W({__name:"index",setup(pe){const u=i([{id:1,serviceName:"政务门户",owner:"李明",status:"正常",lastCheck:"2025-05-01 09:00",desc:"门户网站运行正常"},{id:2,serviceName:"人口管理",owner:"王芳",status:"告警",lastCheck:"2025-05-01 08:30",desc:"接口响应慢"},{id:3,serviceName:"视频监控",owner:"赵强",status:"异常",lastCheck:"2025-05-31 17:00",desc:"部分摄像头离线"},{id:4,serviceName:"数据共享",owner:"孙丽",status:"正常",lastCheck:"2025-05-31 16:00",desc:"数据同步正常"},{id:5,serviceName:"应急指挥",owner:"周伟",status:"正常",lastCheck:"2025-05-30 14:00",desc:"服务稳定"},{id:6,serviceName:"资产管理",owner:"马俊",status:"异常",lastCheck:"2025-05-29 11:00",desc:"数据库连接失败"},{id:7,serviceName:"工单系统",owner:"许静",status:"正常",lastCheck:"2025-05-28 09:00",desc:"无异常"},{id:8,serviceName:"能耗监控",owner:"宋倩",status:"告警",lastCheck:"2025-05-27 13:00",desc:"能耗超阈值"},{id:9,serviceName:"安全事件",owner:"魏东",status:"正常",lastCheck:"2025-05-26 10:00",desc:"无安全告警"},{id:10,serviceName:"备份任务",owner:"冯媛",status:"正常",lastCheck:"2025-05-25 15:00",desc:"备份完成"}]),B=i([]),_=U({normal:0,error:0,warning:0}),N=i(null),C=i({days:["3-26","3-27","3-28","3-29","3-30","3-31","4-1"],normal:[6,6,7,7,7,7,7],error:[2,2,2,2,2,2,1],warning:[2,2,1,1,1,1,2]}),r=U({keyword:"",status:""}),g=i(1),k=i(10),E=i(0),h=i(!1),b=i("add"),S=i(),o=U({id:0,serviceName:"",owner:"",status:"正常",lastCheck:"",desc:""}),D={serviceName:[{required:!0,message:"请输入服务名称",trigger:"blur"}],owner:[{required:!0,message:"请输入负责人",trigger:"blur"}],status:[{required:!0,message:"请选择健康状态",trigger:"change"}],lastCheck:[{required:!0,message:"请选择最近检查时间",trigger:"change"}]},c=()=>{let s=[...u.value];r.keyword&&(s=s.filter(e=>e.serviceName.includes(r.keyword)||e.owner.includes(r.keyword))),r.status&&(s=s.filter(e=>e.status===r.status)),E.value=s.length,B.value=s.slice((g.value-1)*k.value,g.value*k.value),R()},F=()=>{r.keyword="",r.status="",g.value=1,c()},q=()=>{b.value="add",h.value=!0,o.id=0,o.serviceName="",o.owner="",o.status="正常",o.lastCheck="",o.desc=""},I=s=>{b.value="edit",h.value=!0,Object.assign(o,s)},M=s=>{te.confirm("确定要删除该服务吗？","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{const e=u.value.findIndex(m=>m.id===s.id);e!==-1&&(u.value.splice(e,1),c(),z.success("删除成功"))})},j=async()=>{S.value&&await S.value.validate(s=>{if(s){if(b.value==="add"){const e={...o,id:Date.now()};u.value.unshift(e),c(),z.success("新增成功")}else{const e=u.value.findIndex(m=>m.id===o.id);e!==-1&&(u.value[e]={...o,id:o.id},c(),z.success("修改成功"))}h.value=!1}})},$=s=>{k.value=s,c()},H=s=>{g.value=s,c()};function R(){_.normal=u.value.filter(s=>s.status==="正常").length,_.error=u.value.filter(s=>s.status==="异常").length,_.warning=u.value.filter(s=>s.status==="告警").length}function K(){if(!N.value)return;ae(N.value).setOption({tooltip:{trigger:"axis"},legend:{data:["正常","异常","告警"]},grid:{left:40,right:20,top:40,bottom:30},xAxis:{type:"category",data:C.value.days},yAxis:{type:"value",minInterval:1},series:[{name:"正常",type:"line",data:C.value.normal,smooth:!0,lineStyle:{color:"#67C23A"}},{name:"异常",type:"line",data:C.value.error,smooth:!0,lineStyle:{color:"#F56C6C"}},{name:"告警",type:"line",data:C.value.warning,smooth:!0,lineStyle:{color:"#E6A23C"}}]})}return X(()=>{c(),R(),Y(()=>{K()})}),(s,e)=>{const m=n("el-card"),V=n("el-input"),p=n("el-form-item"),w=n("el-option"),T=n("el-select"),f=n("el-button"),A=n("el-form"),y=n("el-table-column"),L=n("el-tag"),O=n("el-table"),P=n("el-pagination"),G=n("el-date-picker"),J=n("el-dialog");return le(),Z("div",oe,[d("div",ne,[t(m,{class:"stat-card",shadow:"hover"},{default:l(()=>[e[11]||(e[11]=d("div",{class:"stat-title"},"正常服务",-1)),d("div",re,x(_.normal),1)]),_:1,__:[11]}),t(m,{class:"stat-card",shadow:"hover"},{default:l(()=>[e[12]||(e[12]=d("div",{class:"stat-title"},"异常服务",-1)),d("div",de,x(_.error),1)]),_:1,__:[12]}),t(m,{class:"stat-card",shadow:"hover"},{default:l(()=>[e[13]||(e[13]=d("div",{class:"stat-title"},"告警服务",-1)),d("div",ie,x(_.warning),1)]),_:1,__:[13]})]),t(m,{class:"trend-card",shadow:"hover"},{default:l(()=>[e[14]||(e[14]=d("div",{class:"trend-title"},"近7天服务健康趋势",-1)),d("div",{ref_key:"trendChartRef",ref:N,class:"trend-chart"},null,512)]),_:1,__:[14]}),d("div",ue,[t(A,{inline:!0,model:r,class:"search-form"},{default:l(()=>[t(p,null,{default:l(()=>[t(V,{modelValue:r.keyword,"onUpdate:modelValue":e[0]||(e[0]=a=>r.keyword=a),placeholder:"服务名称/负责人",clearable:"",onKeyup:ee(c,["enter"])},null,8,["modelValue"])]),_:1}),t(p,null,{default:l(()=>[t(T,{modelValue:r.status,"onUpdate:modelValue":e[1]||(e[1]=a=>r.status=a),placeholder:"健康状态",clearable:"",style:{width:"140px"}},{default:l(()=>[t(w,{label:"正常",value:"正常"}),t(w,{label:"异常",value:"异常"}),t(w,{label:"告警",value:"告警"})]),_:1},8,["modelValue"])]),_:1}),t(p,null,{default:l(()=>[t(f,{type:"primary",onClick:c},{default:l(()=>e[15]||(e[15]=[v("搜索")])),_:1,__:[15]}),t(f,{onClick:F},{default:l(()=>e[16]||(e[16]=[v("重置")])),_:1,__:[16]})]),_:1})]),_:1},8,["model"])]),t(m,{class:"health-list"},{default:l(()=>[t(f,{type:"primary",link:"",onClick:q,style:{"margin-bottom":"12px"}},{default:l(()=>e[17]||(e[17]=[v("新增服务")])),_:1,__:[17]}),t(O,{data:B.value,border:"",style:{width:"100%"}},{default:l(()=>[t(y,{prop:"serviceName",label:"服务名称","min-width":"140"}),t(y,{prop:"owner",label:"负责人","min-width":"100"}),t(y,{prop:"status",label:"健康状态","min-width":"100"},{default:l(({row:a})=>[t(L,{type:a.status==="正常"?"success":a.status==="告警"?"warning":"danger"},{default:l(()=>[v(x(a.status),1)]),_:2},1032,["type"])]),_:1}),t(y,{prop:"lastCheck",label:"最近检查","min-width":"160"}),t(y,{prop:"desc",label:"描述","min-width":"180"}),t(y,{label:"操作",width:"180"},{default:l(({row:a})=>[t(f,{type:"primary",link:"",onClick:Q=>I(a)},{default:l(()=>e[18]||(e[18]=[v("编辑")])),_:2,__:[18]},1032,["onClick"]),t(f,{type:"danger",link:"",onClick:Q=>M(a)},{default:l(()=>e[19]||(e[19]=[v("删除")])),_:2,__:[19]},1032,["onClick"])]),_:1})]),_:1},8,["data"]),d("div",ce,[t(P,{"current-page":g.value,"onUpdate:currentPage":e[2]||(e[2]=a=>g.value=a),"page-size":k.value,"onUpdate:pageSize":e[3]||(e[3]=a=>k.value=a),"page-sizes":[10,20,50,100],total:E.value,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:$,onCurrentChange:H},null,8,["current-page","page-size","total"])])]),_:1}),t(J,{modelValue:h.value,"onUpdate:modelValue":e[10]||(e[10]=a=>h.value=a),title:b.value==="add"?"新增服务":"编辑服务",width:"500px"},{footer:l(()=>[t(f,{onClick:e[9]||(e[9]=a=>h.value=!1)},{default:l(()=>e[20]||(e[20]=[v("取消")])),_:1,__:[20]}),t(f,{type:"primary",onClick:j},{default:l(()=>e[21]||(e[21]=[v("确定")])),_:1,__:[21]})]),default:l(()=>[t(A,{ref_key:"healthFormRef",ref:S,model:o,rules:D,"label-width":"90px"},{default:l(()=>[t(p,{label:"服务名称",prop:"serviceName"},{default:l(()=>[t(V,{modelValue:o.serviceName,"onUpdate:modelValue":e[4]||(e[4]=a=>o.serviceName=a),placeholder:"请输入服务名称"},null,8,["modelValue"])]),_:1}),t(p,{label:"负责人",prop:"owner"},{default:l(()=>[t(V,{modelValue:o.owner,"onUpdate:modelValue":e[5]||(e[5]=a=>o.owner=a),placeholder:"请输入负责人"},null,8,["modelValue"])]),_:1}),t(p,{label:"健康状态",prop:"status"},{default:l(()=>[t(T,{modelValue:o.status,"onUpdate:modelValue":e[6]||(e[6]=a=>o.status=a),placeholder:"请选择健康状态",style:{width:"140px"}},{default:l(()=>[t(w,{label:"正常",value:"正常"}),t(w,{label:"异常",value:"异常"}),t(w,{label:"告警",value:"告警"})]),_:1},8,["modelValue"])]),_:1}),t(p,{label:"最近检查",prop:"lastCheck"},{default:l(()=>[t(G,{modelValue:o.lastCheck,"onUpdate:modelValue":e[7]||(e[7]=a=>o.lastCheck=a),type:"datetime",placeholder:"选择时间",style:{width:"100%"}},null,8,["modelValue"])]),_:1}),t(p,{label:"描述",prop:"desc"},{default:l(()=>[t(V,{modelValue:o.desc,"onUpdate:modelValue":e[8]||(e[8]=a=>o.desc=a),placeholder:"请输入描述"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}}),ge=se(me,[["__scopeId","data-v-346dfd89"]]);export{ge as default};
