import{d as $e,a as le,r as u,v as Ne,D as Be,c as I,b as k,m as x,J as T,e as l,w as t,f as r,i as Pe,F as te,n as ae,j as i,g as j,K as oe,L as Se,t as N,M as B,E as v,o as g}from"./index-B_f_SlH6.js";import{_ as De}from"./_plugin-vue_export-helper-DlAUqK2U.js";const ze={class:"user-container"},Ee={class:"operation-bar"},Fe={class:"operation-buttons"},Le={class:"table-actions"},Me={class:"pagination"},qe={class:"dialog-footer"},Ie={class:"role-operation"},je={class:"table-actions"},Ke=$e({__name:"index",setup(Ae){const n=le({keyword:"",role:"",status:""}),P=[{label:"管理员",value:"admin"},{label:"运维人员",value:"manager"},{label:"普通用户",value:"user"}],b=u([{id:1,username:"admin",realName:"系统管理员",phone:"13800138000",email:"admin@example.com",role:"admin",status:"active",createTime:"2024-03-20 10:00:00"},{id:2,username:"operator",realName:"运维人员",phone:"13800138001",email:"operator@example.com",role:"manager",status:"active",createTime:"2024-03-20 09:00:00"}]),K=u([]),y=u(1),w=u(10),S=u(100),V=u(!1),h=u("add"),D=u(),s=le({id:0,username:"",realName:"",phone:"",email:"",role:"",status:"active",createTime:""}),ne={username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:3,max:20,message:"长度在 3 到 20 个字符",trigger:"blur"}],realName:[{required:!0,message:"请输入姓名",trigger:"blur"}],phone:[{required:!0,message:"请输入手机号",trigger:"blur"},{pattern:/^1[3-9]\d{9}$/,message:"请输入正确的手机号",trigger:"blur"}],email:[{required:!0,message:"请输入邮箱",trigger:"blur"},{type:"email",message:"请输入正确的邮箱地址",trigger:"blur"}],role:[{required:!0,message:"请选择角色",trigger:"change"}]},z=u(!1),E=u("list"),U=u([{id:1,name:"管理员",code:"admin",description:"系统管理员，拥有所有权限",createTime:"2024-03-20 10:00:00"},{id:2,name:"运维人员",code:"manager",description:"运维人员，负责系统维护",createTime:"2024-03-20 09:00:00"}]),se=u(),A=u([{id:1,name:"系统管理",children:[{id:11,name:"用户管理"},{id:12,name:"角色管理"},{id:13,name:"权限管理"}]},{id:2,name:"设备管理",children:[{id:21,name:"设备列表"},{id:22,name:"设备监控"},{id:23,name:"设备维护"}]}]),O=u([11,21]),J=o=>{const e=P.find(p=>p.value===o);return e?e.label:o},c=()=>{let o=[...b.value];n.keyword&&(o=o.filter(e=>e.username.includes(n.keyword)||e.phone.includes(n.keyword))),n.role&&(o=o.filter(e=>e.role===n.role)),n.status&&(o=o.filter(e=>e.status===n.status)),S.value=o.length,K.value=o.slice((y.value-1)*w.value,y.value*w.value)},G=()=>{n.keyword="",n.role="",n.status="",y.value=1,c()},ie=()=>{h.value="add",V.value=!0,s.id=0,s.username="",s.realName="",s.phone="",s.email="",s.role="",s.status="active",s.createTime=""},re=o=>{h.value="edit",V.value=!0,Object.assign(s,o)},ue=o=>{B.confirm("确定要删除该用户吗？","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{const e=b.value.findIndex(p=>p.id===o.id);e!==-1&&(b.value.splice(e,1),c(),v.success("删除成功"),S.value=b.value.length)})},de=o=>{const e=o.status==="active"?"启用":"禁用";v.success(`已${e}用户：${o.username}`)},me=async()=>{D.value&&await D.value.validate(o=>{if(o){if(h.value==="add"){const e={...s,id:Date.now(),createTime:new Date().toLocaleString()};b.value.unshift(e),c(),v.success("新增成功")}else{const e=b.value.findIndex(p=>p.id===s.id);e!==-1&&(b.value[e]={...s,id:s.id,createTime:s.createTime},c(),v.success("修改成功"))}V.value=!1}})},pe=o=>{w.value=o,c()},ce=o=>{y.value=o,c()},fe=()=>{z.value=!0},ve=()=>{B.prompt("请输入新角色名称","新增角色",{confirmButtonText:"确定",cancelButtonText:"取消",inputPattern:/^.{2,20}$/,inputErrorMessage:"角色名称长度为2-20个字符"}).then(({value:o})=>{const e={id:Date.now(),name:o,code:o.toLowerCase(),description:"",createTime:new Date().toLocaleString()};U.value.push(e),v.success("新增角色成功")})},_e=o=>{B.prompt("请输入新的角色名称","编辑角色",{confirmButtonText:"确定",cancelButtonText:"取消",inputValue:o.name,inputPattern:/^.{2,20}$/,inputErrorMessage:"角色名称长度为2-20个字符"}).then(({value:e})=>{o.name=e,v.success("编辑角色成功")})},ge=o=>{B.confirm("确定要删除该角色吗？","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{const e=U.value.findIndex(p=>p.id===o.id);e!==-1&&(U.value.splice(e,1),v.success("删除成功"))})},be=o=>{E.value="permission",O.value=[11,21],v.info(`为角色【${o.name}】分配权限（仅模拟）`)},C=u(!1),H=u([]),ye=u(null),ke=u(),Ve=o=>{ye.value=o.id,H.value=[11,21],C.value=!0},we=()=>{v.success("权限已保存（仅模拟）"),C.value=!1},Q=Ne(()=>!!n.role||!!n.status||!!n.keyword),F=o=>{n[o]="",y.value=1,c()};return Be(()=>{c()}),(o,e)=>{const p=r("el-input"),f=r("el-form-item"),R=r("el-option"),L=r("el-select"),d=r("el-button"),W=r("el-form"),M=r("el-icon"),$=r("el-tag"),Ce=r("el-row"),m=r("el-table-column"),xe=r("el-switch"),X=r("el-table"),Te=r("el-pagination"),he=r("el-card"),Y=r("el-radio"),Ue=r("el-radio-group"),q=r("el-dialog"),Z=r("el-tree"),ee=r("el-tab-pane"),Re=r("el-tabs");return g(),I("div",ze,[k("div",Ee,[l(W,{inline:!0,model:n,class:"search-form"},{default:t(()=>[l(f,null,{default:t(()=>[l(p,{modelValue:n.keyword,"onUpdate:modelValue":e[0]||(e[0]=a=>n.keyword=a),placeholder:"用户名/手机号",clearable:"",onKeyup:Pe(c,["enter"])},null,8,["modelValue"])]),_:1}),l(f,null,{default:t(()=>[l(L,{modelValue:n.role,"onUpdate:modelValue":e[1]||(e[1]=a=>n.role=a),placeholder:"角色",clearable:"",style:{width:"140px"}},{default:t(()=>[(g(),I(te,null,ae(P,a=>l(R,{key:a.value,label:a.label,value:a.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),l(f,null,{default:t(()=>[l(L,{modelValue:n.status,"onUpdate:modelValue":e[2]||(e[2]=a=>n.status=a),placeholder:"状态",clearable:"",style:{width:"140px"}},{default:t(()=>[l(R,{label:"启用",value:"active"}),l(R,{label:"禁用",value:"inactive"})]),_:1},8,["modelValue"])]),_:1}),l(f,null,{default:t(()=>[l(d,{type:"primary",onClick:c},{default:t(()=>e[20]||(e[20]=[i("搜索")])),_:1,__:[20]}),l(d,{onClick:G},{default:t(()=>e[21]||(e[21]=[i("重置")])),_:1,__:[21]})]),_:1})]),_:1},8,["model"]),k("div",Fe,[l(d,{type:"primary",onClick:ie},{default:t(()=>[l(M,null,{default:t(()=>[l(j(oe))]),_:1}),e[22]||(e[22]=i("新增用户 "))]),_:1,__:[22]}),l(d,{type:"success",onClick:fe},{default:t(()=>[l(M,null,{default:t(()=>[l(j(Se))]),_:1}),e[23]||(e[23]=i("角色管理 "))]),_:1,__:[23]})])]),Q.value?(g(),x(Ce,{key:0,class:"filter-tags",style:{"margin-bottom":"10px"}},{default:t(()=>[n.role?(g(),x($,{key:0,type:"info",closable:"",onClose:e[3]||(e[3]=()=>F("role"))},{default:t(()=>[i(" 角色："+N(J(n.role)),1)]),_:1})):T("",!0),n.status?(g(),x($,{key:1,type:"info",closable:"",onClose:e[4]||(e[4]=()=>F("status"))},{default:t(()=>[i(" 状态："+N(n.status==="active"?"启用":"禁用"),1)]),_:1})):T("",!0),n.keyword?(g(),x($,{key:2,type:"info",closable:"",onClose:e[5]||(e[5]=()=>F("keyword"))},{default:t(()=>[i(" 关键词："+N(n.keyword),1)]),_:1})):T("",!0),Q.value?(g(),x(d,{key:3,size:"small",type:"text",onClick:G},{default:t(()=>e[24]||(e[24]=[i("清除全部")])),_:1,__:[24]})):T("",!0)]),_:1})):T("",!0),l(he,{class:"user-list"},{default:t(()=>[l(X,{data:K.value,border:"",style:{width:"100%"}},{default:t(()=>[l(m,{type:"selection",width:"55"}),l(m,{prop:"username",label:"用户名","min-width":"120"}),l(m,{prop:"realName",label:"姓名","min-width":"120"}),l(m,{prop:"phone",label:"手机号","min-width":"120"}),l(m,{prop:"email",label:"邮箱","min-width":"180"}),l(m,{prop:"role",label:"角色","min-width":"120"},{default:t(({row:a})=>[l($,{type:a.role==="admin"?"danger":a.role==="manager"?"warning":"info"},{default:t(()=>[i(N(J(a.role)),1)]),_:2},1032,["type"])]),_:1}),l(m,{prop:"status",label:"状态",width:"100"},{default:t(({row:a})=>[l(xe,{modelValue:a.status,"onUpdate:modelValue":_=>a.status=_,"active-value":"active","inactive-value":"inactive",onChange:_=>de(a)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1}),l(m,{prop:"createTime",label:"创建时间","min-width":"180"}),l(m,{label:"操作",width:"300"},{default:t(({row:a})=>[k("div",Le,[l(d,{type:"primary",link:"",onClick:_=>re(a)},{default:t(()=>e[25]||(e[25]=[i("编辑")])),_:2,__:[25]},1032,["onClick"]),l(d,{type:"primary",link:"",onClick:_=>Ve(a)},{default:t(()=>e[26]||(e[26]=[i("权限")])),_:2,__:[26]},1032,["onClick"]),l(d,{type:"danger",link:"",onClick:_=>ue(a)},{default:t(()=>e[27]||(e[27]=[i("删除")])),_:2,__:[27]},1032,["onClick"])])]),_:1})]),_:1},8,["data"]),k("div",Me,[l(Te,{"current-page":y.value,"onUpdate:currentPage":e[6]||(e[6]=a=>y.value=a),"page-size":w.value,"onUpdate:pageSize":e[7]||(e[7]=a=>w.value=a),"page-sizes":[10,20,50,100],total:S.value,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:pe,onCurrentChange:ce},null,8,["current-page","page-size","total"])])]),_:1}),l(q,{modelValue:V.value,"onUpdate:modelValue":e[15]||(e[15]=a=>V.value=a),title:h.value==="add"?"新增用户":"编辑用户",width:"500px"},{footer:t(()=>[k("span",qe,[l(d,{onClick:e[14]||(e[14]=a=>V.value=!1)},{default:t(()=>e[30]||(e[30]=[i("取消")])),_:1,__:[30]}),l(d,{type:"primary",onClick:me},{default:t(()=>e[31]||(e[31]=[i("确定")])),_:1,__:[31]})])]),default:t(()=>[l(W,{ref_key:"userFormRef",ref:D,model:s,rules:ne,"label-width":"80px"},{default:t(()=>[l(f,{label:"用户名",prop:"username"},{default:t(()=>[l(p,{modelValue:s.username,"onUpdate:modelValue":e[8]||(e[8]=a=>s.username=a),placeholder:"请输入用户名"},null,8,["modelValue"])]),_:1}),l(f,{label:"姓名",prop:"realName"},{default:t(()=>[l(p,{modelValue:s.realName,"onUpdate:modelValue":e[9]||(e[9]=a=>s.realName=a),placeholder:"请输入姓名"},null,8,["modelValue"])]),_:1}),l(f,{label:"手机号",prop:"phone"},{default:t(()=>[l(p,{modelValue:s.phone,"onUpdate:modelValue":e[10]||(e[10]=a=>s.phone=a),placeholder:"请输入手机号"},null,8,["modelValue"])]),_:1}),l(f,{label:"邮箱",prop:"email"},{default:t(()=>[l(p,{modelValue:s.email,"onUpdate:modelValue":e[11]||(e[11]=a=>s.email=a),placeholder:"请输入邮箱"},null,8,["modelValue"])]),_:1}),l(f,{label:"角色",prop:"role"},{default:t(()=>[l(L,{modelValue:s.role,"onUpdate:modelValue":e[12]||(e[12]=a=>s.role=a),placeholder:"请选择角色"},{default:t(()=>[(g(),I(te,null,ae(P,a=>l(R,{key:a.value,label:a.label,value:a.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),l(f,{label:"状态",prop:"status"},{default:t(()=>[l(Ue,{modelValue:s.status,"onUpdate:modelValue":e[13]||(e[13]=a=>s.status=a)},{default:t(()=>[l(Y,{label:"active"},{default:t(()=>e[28]||(e[28]=[i("启用")])),_:1,__:[28]}),l(Y,{label:"inactive"},{default:t(()=>e[29]||(e[29]=[i("禁用")])),_:1,__:[29]})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"]),l(q,{modelValue:C.value,"onUpdate:modelValue":e[17]||(e[17]=a=>C.value=a),title:"分配权限",width:"400px"},{footer:t(()=>[l(d,{onClick:e[16]||(e[16]=a=>C.value=!1)},{default:t(()=>e[32]||(e[32]=[i("取消")])),_:1,__:[32]}),l(d,{type:"primary",onClick:we},{default:t(()=>e[33]||(e[33]=[i("保存")])),_:1,__:[33]})]),default:t(()=>[l(Z,{data:A.value,"show-checkbox":"","node-key":"id","default-checked-keys":H.value,props:{label:"name",children:"children"},ref_key:"userPermissionTreeRef",ref:ke},null,8,["data","default-checked-keys"])]),_:1},8,["modelValue"]),l(q,{modelValue:z.value,"onUpdate:modelValue":e[19]||(e[19]=a=>z.value=a),title:"角色管理",width:"800px"},{default:t(()=>[l(Re,{modelValue:E.value,"onUpdate:modelValue":e[18]||(e[18]=a=>E.value=a)},{default:t(()=>[l(ee,{label:"角色列表",name:"list"},{default:t(()=>[k("div",Ie,[l(d,{type:"primary",onClick:ve},{default:t(()=>[l(M,null,{default:t(()=>[l(j(oe))]),_:1}),e[34]||(e[34]=i("新增角色 "))]),_:1,__:[34]})]),l(X,{data:U.value,border:"",style:{width:"100%"}},{default:t(()=>[l(m,{prop:"name",label:"角色名称"}),l(m,{prop:"code",label:"角色编码"}),l(m,{prop:"description",label:"描述"}),l(m,{prop:"createTime",label:"创建时间"}),l(m,{label:"操作",width:"200"},{default:t(({row:a})=>[k("div",je,[l(d,{type:"primary",link:"",onClick:_=>_e(a)},{default:t(()=>e[35]||(e[35]=[i("编辑")])),_:2,__:[35]},1032,["onClick"]),l(d,{type:"primary",link:"",onClick:_=>be(a)},{default:t(()=>e[36]||(e[36]=[i("权限")])),_:2,__:[36]},1032,["onClick"]),l(d,{type:"danger",link:"",onClick:_=>ge(a)},{default:t(()=>e[37]||(e[37]=[i("删除")])),_:2,__:[37]},1032,["onClick"])])]),_:1})]),_:1},8,["data"])]),_:1}),l(ee,{label:"权限配置",name:"permission"},{default:t(()=>[l(Z,{ref_key:"permissionTreeRef",ref:se,data:A.value,"show-checkbox":"","node-key":"id","default-checked-keys":O.value,props:{label:"name",children:"children"}},null,8,["data","default-checked-keys"])]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["modelValue"])])}}}),Ge=De(Ke,[["__scopeId","data-v-f3f6a31c"]]);export{Ge as default};
